 select* from(SELECT
        c.METER_ID as meter_id,
        CASE
		WHEN MAX (a.DATA_TIME) IS NULL
		OR MAX (a.DATA_TIME) = '' THEN
			MAX (c.install_date)
		ELSE
			MAX (a.DATA_TIME)
		END AS DATA_TIME,
		MAX (b.address) AS address
        FROM
        A_METER_INFO c
        JOIN A_CUSTOMER_INFO b ON c.ACC_NO = b.acc_no
        left JOIN M_METER_DATA a ON a.METER_ID = c.meter_id

        where b.account_status='90' and c.meter_status='03'
        group by c.METER_ID) d

        where d.DATA_TIME < CAST (
        CONVERT (
        VARCHAR (10),
        GETDATE()-1,
        120
        ) + ' 00:00:00' AS datetime
        )